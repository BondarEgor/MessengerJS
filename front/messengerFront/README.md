# Фронтенд

## Требования к функционалу пользователя

### 1. Логин/Разлогин
1.0. Предусмотреть возможность логина и регистрации  
1.1. Для логина пользователю необходимо ввести валидный пароль и логин и нажать кнопку "Войти"  
1.2. Добавить валидацию для полей, обсудить какой она должна быть (может позаимствовать существующие валидаторы где-нибудь)  
1.3. Блокировать кнопку (disabled) при невалидных значениях, чтобы не пускать пользователя дальше  
1.4. Валидировать в процессе ввода так, чтобы убрав фокус с поля логин или пароль, юзер не успевал нажать "Войти" и кнопка блокировалась, а также появлялись сообщения-подсказки, по типу: "Ваш логин или пароль неверный"  
1.5. Проверить, что блокировка снимается и можно пройти по флоу дальше, если пользователь исправил ошибки в логине и пароле и ввел валидные значения  
1.6. При клике на кнопку "Войти" отправляем запрос на бэк и передаем данные пользователя, в ответ получаем либо success либо error.  
    - Если success: сохраняем на фронте сессию и авторизуем пользователя, редиректим его на страницу чата  
    - Если error: оставляем пользователя на странице авторизации и предлагаем авторизоваться повторно, либо зарегистрироваться, если он еще этого не сделал  
1.7. Добавить ограничение на попытки логина (допустим 5-10), в определенное время предлагать повторно зарегистрироваться  
1.8. При клике на регистрацию рендерить отдельный компонент и вести на другой URL /registration (для логина сделать свой /login)  
1.9. На странице регистрации сделать 3 поля: Имя, пароль, почта (логин). Для авторизации использовать почту + пароль (имя нельзя - это просто для отображения имени хозяина чата)  
1.10. Добавить валидацию такую же, как и на странице с логином, но можно валидировать всю форму при её сабмите, а не по факту ввода  
1.11. При невалидных данных показываем юзеру ошибки-подсказки (кнопку можем не блочить, т.к. валидация будет после)  
1.12. При вводе нужных (валидных) данных и нажатии юзером на кнопку "Зарегистрироваться" слать запрос, который добавит пользователя в БД и вернет нам подтверждение успеха операции, после которой мы можем предложить ему теперь войти в наше приложение  
1.13. Также необходимо предусмотреть, если юзер уже зарегистрирован и пытается сделать это с той же почтой - присылать в ответе запроса флаг и отрисовывать на фронте инфо "Пользователь с данной почтой уже есть - войдите…"  
1.14. Ограничить попытки залогиниться и м.б. устанавливать некий таймер, чтобы юзер не мог продолжать "пробиваться" в приложение  
1.15. В чат пускать без логина нельзя, так как нам нужны перс данные и запросить мы их сможем по конкретному юзеру. Без логина блокировать все урлы, кроме логина/регистрации  

### 2. Переключение между вкладками
2.1. Реализовать возможность переключения по вкладкам и просто менять URL, остальные доработки будут отдельно как фичи, пока не менять список чатов и т.д.

### 3. Проваливание в сообщение
3.1. Юзер должен уметь в отображаемом списке чатов провалиться в конкретный чат и увидеть там переписку  
3.2. По дефолту отображать белый канвас на месте самой переписки, пока юзер в первый раз не нажмет на любой чат (подумать над дизайном)  
3.3. Внутри переписки делить сообщения на входящие и исходящие, помечая их соответствующими цветами и располагая их слева и справа соответственно  
3.4. Внутри чата также подтягивать параметры пользователя (обсудить): аватарка, статус, Имя  
3.5. Возможность скролить внутри блока переписки и чтобы body было overflow-y-hidden. Также ранжировать переписку по датам, снизу самые последние сообщения  
3.6. Подписывать каждое сообщение именем человека, который его отправил (в случае собственных сообщений писать YOU), а также указывать время отправки и статус прочтения собеседником:  
    - Одна галочка - доставлено, не прочитано  
    - Две галочки - доставлено и прочитано  
3.7. Реализовать инпут с текстом, ограничить пустой ввод, пока еще можно просто реализовать элемент подгрузки медиа файлов (нерабочий)  
3.8. При отправке нового сообщения через инпут создавать блок с текстом  
3.9. Уметь идентифицировать исходящие и входящие сообщения через бэк, чтобы при заходе внутрь чата мы правильно получали разделение на свои и чужие письма  

### 4. Прочитывание сообщения и обратно делать его непрочитанным
4.1. Если сообщение только пришло и еще не прочитано - помечать его визуально чем-то, чтобы было понятно, что оно непрочитано  

### 5. Поиск по контактам/сообщениям
5.1. Внутри чата у юзера должна быть возможность осуществлять поиск по имени контакта и конкретному сообщению: если, например, я хочу найти текст: "Привет, как дела", поиск должен вернуть мне чат, где это было прописано или все чаты с таким текстом  
5.2. После ввода в поиск, вместо чата появятся сообщения (если поиск по юзерам не дал результата) или сам юзер. Написали "Егор" - вернулся список всех юзеров с именем Егор  

### 6. Закреплять контакты, чтобы они всегда были сверху
6.1. Реализовать возможность добавить любые контакты наверх чата, чтобы юзер всегда мог их наблюдать наверху и не скроллить по всему приложению  

### 7. Добавлять новый контакт
7.1. Добавить возможность нажать на + (подумать над дизайном) и проваливаться в модалку, где есть способ поиска контакта (зарегистрированного внутри нашего чата) по нику, телефону, почте (подумать). Модалка будет выглядеть примерно так:  

### 8. Переводить письма в архив
8.1. Если пользователь захочет переместить письмо в архив, то нужно придумать флаг, который с бэка не будет нам возвращать этот чат вместе со всеми. Вместо этого он прилетит внутри вкладки Архив (которая будет реализовываться отдельно фичей, пока просто можно добавить флаг на бэк)  

### 9. Удалять письма, перемещая их в корзину
9.1. Реализовать удаление чата через бэк, но не удалять их из БД. Сделать так, чтобы пользователь просто мог удалить их из своего чата, но при необходимости, чтобы можно было восстановить их, используя админа чата  
9.2. Визуально реализовать это через кебаб меню, в котором будет несколько опций, одна из которых будет удаление. Нажав на нее, будем отправлять запрос на бэк и вешать флаг deleted  

### 10. Восстанавливать письма из корзины
10.1. При восстановлении удаленного чата юзер сам это сделать не сможет. Ему необходимо обладать правами админа, а админ сможет восстановить чат из БД, сняв с него флаг. Пока, наверное, просто на подумать, но я вижу это именно так, посмотрев по аналогам  

### 11. Создавать чат группы, минимум на два человека, чтобы сообщения были доступны внутри для всех участников
11.1. У нас на фронте должна быть возможность создать группу, в том месте, где мы решим хранить все опции юзера. Это может быть бургер-меню в углу экрана, которое будет иметь примерно такой вид:  
11.2. После нажатия на "New Group" у нас открывается модалка  
11.3. Мы выбираем имя, идем дальше, а потом нам нужно добавить туда юзеров (пока про ограничения, наверное, не придумал, их как будто нет)  
11.4. Добавив юзеров и кликнув "OK", у нас закрывается модалка, и мы видим новый чат в топе списка. Все участники чата у себя его также видят  

### 12. Отправлять сообщения другим пользователям и получать от них сообщения в ответ
12.1. Реализовать элемент (textarea, input), в котором пользователю можно вводить сообщение, настроить ограничение по пустому вводу (писал выше), добавить кнопку "Отправить". При нажатии на нее собирать из инпута значение, слать на бэк и перезагружать "незаметно" чат, вызывая метод получения переписки по id  

### 13. Отправлять файлы/картинки - опционально
13.1. Пока просто можно добавить заглушки, либо вообще оставить это. На скрине выше есть  

### 14. Внутри переписки хранить сообщения по датам и показывать эту дату
14.1. Что в целом нужно хранить:  
    - Логин юзера  
    - Полные имя фамилию  
    - Его статус (онлайн, оффлайн)  
    - Время последнего визита (когда был онлайн)  
    - По сообщению хранить дату отправки, от кого было отправлено  
    - В качестве пагинации можно подумать в сторону значения, чтобы был запас на один полный скролл мб, можно 10-15 сообщений, остальные через lazy load наверное делать  

### 15. Демонстрировать статус пользователя: Онлайн/Оффлайн/Кастомные (Отошел)
15.1. Реализовать управление за счет системы и также, чтобы юзер сам мог выбрать свой текущий статус  
15.2. Касаемо системы, следить за тем, находится ли юзер в приложении вообще (статус онлайн), активен ли он. Если нет, то статус "Отошел" (надо подумать, как это трекать правильно, наверное через то, является ли вкладка активной или нет на протяжении определенного времени, то есть если мы ушли со вкладки, но не закрывали приложение, то запускается некий таймер в 5 минут, по прошествии - выставляем статус "Отошел", как только юзер вернулся и активировал табу - статус "Онлайн"  
15.3. Если у юзера приложение закрыто - выставлять статус "Оффлайн". Пока можно начать с таких, а дальше кастомизировать. Все перечисленные статусы можно также задавать собственноручно каждому юзеру  
15.4. Визуально это можно реализовать также, как у нас в TIME - показывать значок (красный, зеленый, желтый…) и при наведении демонстрировать текст, который пользователь сможет выставлять кастомно  

### 16. Профиль юзера - настройки ЛК
16.1. Нужно реализовать:  
    - Уведомления on/off  
    - Смена никнейма, например, надо подумать в эту сторону, насчет валидации, может  
    - Может настроить пуши на телефон on/off - тоже как доп фича  
    - Пускай в ЛК хранится аватарка, пока можно это заглушить, добавить верстку для портрета круглого, дальше добавить возможность кликнуть по нему, подгрузить с системы картинку и вставить туда. Также ограничить размер картинки, форматы  